<%= form_for [@group, @topic.becomes(Topic)] do |f| %>
  <%= render "error_messages", object: @topic %>

  <div class="form-group box p-4 mt-2rem mb-2rem">
    <div class="form-group">
      <%= f.label :title %>
      <small class="text-muted">Required *</small>
      <%= f.text_field :title, class: "form-control",
        required: true %>
    </div>

    <div class="form-group mb-0">
      <%= f.label :body %>
      <small class="text-muted">Required *</small>
      <%= f.hidden_field :body, required: true %>
      <trix-editor input="topic_body" class="form-control">
      </trix-editor>
    </div>
  </div>

  <% if is_admin?(@group) && announceable?(@topic) %>
    <div class="box announcement-box p-4 mb-2rem">
      <%= f.label :announcement, "Announcement:", class: "mb-0" %>

      <%= f.radio_button :announcement, true,
        checked: !!@topic.announcement %>
      <%= f.label :announcement_true, "Yes", class: "mb-0" %>

      <%= f.radio_button :announcement, false,
        checked: checked_if_not_set(@topic.announcement) %>
      <%= f.label :announcement_false, "No", class: "mb-0" %>

      <% if action_name == "new" %>
        <p class="font-italic mt-3 mb-0">
          If you create the topic as an announcement, all members would receive a notification.
        </p>
      <% else %>
        <p class="font-italic mt-3 mb-0">
          This action is not reversible.
        </p>
      <% end %>
    </div>
  <% end %>

  <% if action_name == "edit" %>
    <div class="form-group box p-4 mb-2rem">
      <h3 class="mb-4">Danger zone</h3>

      <div class="form-group mb-0">
        <p class="font-italic mb-4">
          This action is not reversible.
        </p>
        <%= link_to "Delete topic",
          group_topic_path(@group, @topic), method: :delete,
          data: { confirm: "Are you sure you want to delete this topic?" },
          class: "btn btn-danger btn-lg" %>
      </div>
    </div>
  <% end %>

  <%= f.submit yield(:button_text),
    class: "btn btn-primary btn-block btn-lg mt-4 mb-4" %>
<% end %>
